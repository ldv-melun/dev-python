= Python-2 intro - type
// https://github.com/asciidoctor/asciidoctor/issues/1808
ifdef::allbook[]
:isinclude: true
endif::allbook[]
ifeval::["{isinclude}" == "true"]
Lyc√©e L√©onard de Vinci - Melun
v0.1a, 2023-07-16 - Version asciidoc
:description: support avec exercices
:icons: font
:listing-caption: Listing
:toc-title: Table des mati√®res
:toc: left
:toclevels: 4
:source-highlighter: highlight.js
:imagesdir: ../assets/images
endif::[]


== M√©ta-mod√®le IPO

Nous avons vu que les exercices de programmation ont en commun le fait qu'ils traitent des informations et produisent un r√©sultat en retour.

C'est en fait le sch√©ma g√©n√©ral qui est en action dans l'ensemble des syst√®mes.

ENTREE -> TRAITEMENT -> RESULTAT

Le r√©sultat pouvant √™tre une entr√©e vers un autre processus analogue.

En anglais, ce mod√®le est connu sous l'acronyme *IPO* :

INPUT -> PROCESS -> OUTPUT

== D√©terminisme

Lorsqu'il s'agit de programmation, le _process_ du mod√®le IPO, c'est √† dire la partie traitement, se doit d'√™tre *d√©terministe*.

Par d√©terminisme, il faut comprendre qu'une fonction doit, pour un m√™me ensemble de donn√©es d'entr√©e, toujours produire la m√™me sortie.

Par exemple, d√©finissons une fonction qui retourne le signe d'un nombre pass√© en argument :

[source, python]
----
def signe(x: int) -> str: <1>
  """ <2>
   Retourne le signe de son argument.
   soit '+', '-' ou '' (chaine vide) si x==0
  """
  result = '' # pas de signe
  if (x < 0):
    result = '-'
  elif (x > 0): <3>
    result = '+'
  return result
----

<1> On pr√©cise ici le type du premier argument (premier param√®tre) ainsi que le type de retour de la fonction (string). Cette possibilit√© a √©t√© introduite √† partir de la version 3.5 de python. Cette information n'est pour l'heure pas exploit√©e par l'interpr√©teur. (voir https://docs.python.org/3/library/typing.html)

<2> C'est une cha√Æne de documentation ("docstring"). Son but est de pr√©senter le r√¥le de la fonction. C'est √† destination des d√©veloppeurs (pas de l'interpr√©teur). N'h√©sitez pas √† mettre des exemples dans cette partie.
<3> *elif*, une contraction de `else if`, c'est un des https://docs.python.org/fr/3/reference/lexical_analysis.html#keywords[mots cl√©s] de python. 

On pourra appeler autant de fois notre fonction `signe` avec la m√™me valeur de donn√©e d'entr√©e, elle nous retournera toujours le m√™me r√©sultat.

Exemple :

[source, python]
----
print(signe(42)) # +
print(signe(42)) # +
print(signe(40+2)) # +
print(signe(2+2*20)) # +
...
print(signe(-42)) # -
...
print(signe(0)) #

----


[TIP]
====
Une fonction qui ne d√©pend que des valeurs de ses arguments pour r√©aliser son travail, sans impacter le syst√®me, est qualifi√©e de *fonction pure*. 

Une fonction pure a de nombreux avantages, dont celui de permettre la programmation parall√®le. 
====

== Type et op√©rations

Nous avons constat√© (Exercice 7) que les op√©rations sont d√©pendantes du type de la donn√©e sur laquelle elles travaillent.

Il existe des types pr√©d√©finis, dits natifs √† l'interpr√©teur (_Built-in_). Ce sont les *num√©riques*, les *s√©quences*, les *dictionnaires*, les *classes*, les *instances* et les *exceptions*.

Python manipule des objets et certaines op√©rations sont prises en charge par plusieurs types d'objets ; en particulier, pratiquement tous les objets peuvent √™tre compar√©s en √©galit√©, test√©s en valeur de v√©rit√© (valeur bool√©enne) et convertis en une cha√Æne de caract√®res (avec la fonction `repr()` ou la fonction l√©g√®rement diff√©rente `str()`). Cette derni√®re est implicitement utilis√©e quand un objet est affich√© par la fonction print().

== Types num√©riques

Il existe trois types num√©riques distincts : les *entiers* (_integers_), les nombres *flottants* (_floating point numbers_) et les nombres *complexes* (_complex numbers_). En outre, les *bool√©ens* sont un sous-type des entiers. Les entiers ont une pr√©cision illimit√©e.

Exemples d'op√©rations courantes (source : https://docsindex.python.org/fr/3/library/stdtypes.html#numeric-types-int-float-complex[documentation op√©rations])
image:op-type-numerique.png[op et types num√©riques]

== Chaine de caract√®res

Les donn√©es textuelles en Python sont manipul√©es avec des objets `str` ou _strings_. Les cha√Ænes sont des *s√©quences immuables* de points de code Unicode (une suite ordonn√©e d'indice dans la table UNICODE).

TIP: Une donn√©e *immuable* est une donn√©e qui *ne peut pas √™tre modifi√©e* une fois cr√©√©e.


Les cha√Ænes litt√©rales peuvent √™tre √©crites de diff√©rentes mani√®res :

. entre quotes : `'cela autorise les "guillemets"'` ;

. entre guillemets : `"cela autorise les 'simples quotes'"` ;

. entre guillemets triples : `'''Trois simples quotes''', """Trois guillemets"""`.

Les cha√Ænes entre guillemets triples peuvent couvrir plusieurs lignes, *tous les caract√®res de type 'espace' sont alors inclus dans la cha√Æne litt√©rale*.

== Travaux pratiques

En python

‚Ä¢ La fonction *`ord()`* permet de conna√Ætre le code (ou indice) d'un caract√®re UNICODE. Une valeur d'indice dans la table UNICODE allant de 0 √† 1114111 (0x10FFFF en base 16) 
‚Ä¢ Inversement, la fonction *`chr()`* permet de conna√Ætre le caract√®re UNICODE associ√© √† une valeur d'indice - voir https://docs.python.org/fr/3/library/functions.html#chr[documentation de la fonction chr]

Exemple d'utilisation (d'appels) de ces fonctions :

  ord('A') ->   65

  chr(65)  ->   'A'

[TIP]
====
La repr√©sentation du glyphe d'un caract√®re UNICODE est de la responsabilit√© du syst√®me d'affichage (d√©pend de la police et du contexte d'affichage)

Voir plus en d√©tail ici : https://docs.python.org/fr/3/howto/unicode.html[python et l'unicode]
====

[IMPORTANT]
====
Le type caract√®re n'existe pas en Python. *Un caract√®re est une cha√Æne de un seul caract√®re*.

*Challenge* : Proposez une POC (preuve de concept) de cette remarque !
====


=== EXERCICE 20


.*Dans un script nomm√© `tp2.py`, r√©aliser, dans une fonction nomm√©e `exo20`, le sc√©nario suivant et l'appeler dans le _main_ :*
. L'utilisateur est invit√© √† saisir un caract√®re.
. Le programme lui affiche successivement les informations suivantes
** Le code du caract√®re
** Le caract√®re pr√©c√©dent
** Le caract√®re suivant

.Exemple d'ex√©cution
[listing]
----
Entrez un caract√®re, svp : A
 # l'utilisateur choisit le caract√®re  'A'
 # le programme r√©pond
Le code du caract√®re est : 65
Le caract√®re pr√©c√©dent  : @
Le caract√®re suivant : B
----

=== EXERCICE 21

Voici une sp√©cification de la fonction pred()
[source]
----
fonction pred() : Caract√®re -> Caract√®re
 # re√ßoit un caract√®re en argument
 # rend, s'il existe, le caract√®re pr√©c√©dent dans la table UNICODE
 # Sinon retourne None (une autre solution consiste √† d√©clencher une exception)

----

.*√Ä faire dans `tp2.py`*
. Traduire la fonction `pred` en python.
. Concevoir la fonction `succ` (caract√®re suivant) en python.
. Tester ces 2 fonctions dans une fonction nomm√©e `exo21` appel√©es dans le main
. R√©√©crire la fonction `exo20` en `exo20bis` en cons√©quence.


[TIP]
====

(Pour les plus avanc√©s)

*Comment d√©clencher une exception en python ?*

Dans le corps de la fonction, utiliser le mot cl√© *`raise`* suivi d'une classe d'exception et d'un message. Exemple :

[source, python]
----
raise ValueError('A very specific bad thing happened.')
----

Vous pouvez consulter la discussion ici : https://stackoverflow.com/questions/2052390/manually-raising-throwing-an-exception-in-python
[stackoverflow : manually-raising-throwing-an-exception-in-python]

Le d√©clenchement d'une exception provoque un *arr√™t brutal* de l'interpr√©tation du corps de la fonction dans lequel il est lanc√©, contr√¥lable par un gestionnaire `try .. catch` 
====

=== EXERCICE 22

Concevoir une fonction nomm√©e `exo22` qui respecte le sc√©nario suivant :

. L'utilisateur est invit√© √† saisir un *code* de caract√®re
. Le programme affiche, dans un tableau, le caract√®re correspondant encadr√© √† droite des 5 caract√®res suivants et √† gauche des 5 caract√®res pr√©c√©dents √† condition que leur code soit sup√©rieur ou √©gal √† celui du caract√®re `espace`.

=== EXERCICE 23

Concevoir une fonction nomm√©e `exo23` qui respecte le sc√©nario suivant :

. L'utilisateur est invit√© √† choisir une 'langue' parmi 3 autres - √† vous de les s√©lectionner parmi https://en.wikipedia.org/wiki/Unicode_block[(url) block Unicode]
. Le programme affiche, dans un tableau, les 16 (ou plus ?) premiers caract√®res UNICODE correspondants.

Exemple de 'langue' : https://en.wikipedia.org/wiki/Hangul_Syllables[Hangul_Syllables] Cor√©en. L'indice du block est `U+AC00`. Testons le premier caract√®re en mode python interactif:

[source, python]
----
>>> ord('\uAC00')
44032

# saute les 2 premiers caract√®res de la chaine 'U+AC00'
>>> int('U+AC00'[2:], base=16) 
44032

>>> chr(44032)
'Í∞Ä'
----

=== EXERCICE 23Bis

Concevoir une fonction qui attend en 2 param√®tres : un indice de block UNICODE et un nombre de caract√®res √† retourner, et qui retourne la cha√Æne de caract√®res correspondant √† la demande.

Appeler cette fonction dans une nouvelle fonction nomm√©e `exo23bis` et tester cette nouvelle version dans le main.

== Type bool√©en

Le type `bool` est sous-type de `int`, et d√©finit 2 valeurs particuli√®res : `True` et `False`, pour 1 et z√©ro respectivement.

Testons ces caract√©ristiques annonc√©es via une fonction native de Python nomm√©e `isinstance` qui prend 2 arguments : le premier est l'objet √† tester, le second et un type (une classe). Elle rend vrai si le premier argument est du type du second. 

Exemple : `isinstance("42", int)` rendra `False` car "42" est du type `str` et non `int`.    

.POC : type bool is int
[source, python]
----
>>> isinstance(True, bool)
True
>>> isinstance(False, bool)
True

>>> isinstance(True, int)
True
>>> isinstance(False, int)
True

>>> isinstance(True, float)
False

>>> int(True)
1
>>> int(False)
0
----

=== Valeur de v√©rit√©

Toute valeur python peut √™tre interpr√©t√©e en valeur bool√©enne via la fonction `bool()`

.POC type bool
[source, python]
----
>>> bool(1)
True
>>> bool(0)
False
>>> bool(True)
True
>>> bool('Hello World')
True
>>> bool(42)
True
----

En pratique, toute valeure *diff√©rente de z√©ro ou 'vide'* sera consid√©r√©e comme `True`.

==== Valeurs consid√©r√©es comme `False`

Seules quelques constantes litt√©rales sont consid√©r√©es comme fausse :

* `None` et `False`

TIP: Affecter *`None`* √† une variable est une fa√ßon de dire que cette variable n'a pas de valeur significative ou "n'a pas encore de valeur".

.Exemple de POC
[source, python]
----
>>> bool(False)
False

>>> bool(None)
False

>>> bool('None')
True
----

* z√©ro de toute repr√©sentation et type num√©rique : `0, 0_000, 0.0, 0j, Decimal(0), Fraction(0, 1)`

* les cha√Ænes et collections vides : `'', (), [], {}, set(), range(0)`.

Les op√©rations et fonctions natives dont le r√©sultat est bool√©en renvoient toujours `0` ou `False` pour faux et `1` ou `True` pour vrai, sauf indication contraire (exception importante : les op√©rations bool√©ennes or et and renvoient toujours l'une de leurs op√©randes).

=== Op√©rations bool√©ennes  ‚Äî and, or, not

https://docs.python.org/fr/3/library/stdtypes.html#boolean-operations-and-or-not

.op√©rateurs par priorit√© descendante
[cols="1,1,2", options="header"]
|===
|Op√©ration
|R√©sultat
|Note


|`not x`
| si x est faux, alors `True`, sinon `False`
| `not` a une priorit√© inf√©rieure √† celle des op√©rateurs non-bool√©ens, donc `not a == b` est interpr√©t√© comme `not (a == b)` et `a == not b` est une erreur de syntaxe.


|`x and y`
| si x est faux, alors x, sinon y
| C'est un op√©rateur court-circuit, il n'√©value le deuxi√®me argument que si le premier est vrai.

|`x or y`
| si x est vrai, alors x, sinon y
| C'est un op√©rateur court-circuit : il n'√©value le deuxi√®me argument que si le premier est faux.
|===

=== Op√©rateurs de comparaison

Voir le tableau ici : https://docs.python.org/fr/3/library/stdtypes.html#comparisons

== Travaux pratiques

=== EXERCICE 24

.√† renseigner
[cols="2,1,2", options="header"]
|===
|Op√©ration
|R√©sultat
|Justification

|`bool('')` # une chaine vide
|
|

|`bool("")`
|
|

|`bool(' ')` # un espace
|
|

|`bool(2 * 4 - 8)`
|
|

|`bool(42)`
|
|


|`bool(0)`
|
|


|`bool('z√©ro')`
|
|


|`bool(False)`
|
|


|`bool(False != True)`
|
|


|`bool(True != True)`
|
|

|`bool(True * False)`
|
|


|`bool(True - 1)`
|
|

|===



== Type cha√Æne de caract√®res (string)

En python les chaines de caract√®res sont instances du type `str`, et sont des s√©quences ordonn√©es de valeurs de point de code UNICODE, pouvant √™tre not√©es en hexad√©cimal.

[source, python]
----
>>> "\U00000394"
'Œî'
>>> ord("\U00000394")
916
----
Le terminal peut ne pas √™tre en mesure de repr√©senter le *glyphe* du caract√®re UTF-8. Dans ce cas, le syst√®me affiche le point de code.

[source, python]
----
>>> "\U00000394"
'\u0394'
----

Fort heureusement, le d√©veloppeur utilise rarement les point de code directement, pr√©f√©rant les glyphes d√®s que permis.

[source, python]
----
>>> print('\u0394\u0395\u0394')
ŒîŒïŒî

>>> print('ŒîŒïŒî')
ŒîŒïŒî

>>> '\u0394\u0395\u0394'[1]
'Œï'

>>> len('\u0394\u0395\u0394')
3

>>> print("Hello World")
Hello World
----



<<<

=== EXERCICE 25 Op√©rations courantes sur les strings
Voici une liste √† compl√©ter, non exhaustive, d'op√©rations usuelles sur le type `str`, √† renseigner par vous-m√™me √† partir de ces ressources https://docs.python.org/fr/3/library/stdtypes.html#string-methods[string-methods documentation] et https://docs.python.org/fr/3/library/stdtypes.html#common-sequence-operations[common-sequence-operations] - il y a bien entendu d'autres ressources non officielles, comme https://fr.wikibooks.org/wiki/Programmation_Python/Chaines_de_caract%C3%A8res[sur wikibooks.org] par exemple.

.√† compl√©ter √† partir de cet exemple : x = " Hello World ! " (15 caract√®res)
[cols="1,1,2", options="header"]
|===
|Op√©ration
|Python
|Exemple

| Extraire le "caract√®re" 'H' (cha√Æne de longueur 1) de `x`
| Utilisation de la notation `[]` en sp√©cifiant la position de l'√©l√©ment souhait√© 
| `c = x[1]` # _'H' est le 2i√®me √©l√©ment de la cha√Æne r√©f√©renc√©e par x (le premier est un espace)_


| Extraction de la sous-cha√Æne 'Hello'
|
|

| Changement de casse

(majuscule \<\-> minuscule)
|
|
| Suppression de "blancs" en queue et/ou en t√™te
|
|
|Recherche d'une occurrence d'une sous-cha√Æne dans la cha√Æne
|
|
| Compteur le nombre de 'l' dans x
|
|

| Quel est l'op√©rateur de concat√©nation ?

(qui cr√©e une nouvelle `str` √† partir de plusieurs autres)
|
|

| Peut-on comparer des chaines entre elles ?
|
|

| Comment tester qu'un cha√Æne est vide ?
|
|

| Comment obtenir la longueur d'une cha√Æne ?
(nombre de points de code de la cha√Æne)
|
|

| Tentative de conversion : cha√Æne \<\-> num√©rique
|
|
|===



== Travaux pratique

=== EXERCICE 26

On vous demande de programmer le sc√©nario suivant (fonction nomm√©e `exo26`).

L'utilisateur est invit√© √† entrer *deux lignes* de texte respectant chacune le format suivant :
[listing]
----
<public>;<code produit>;<qt√© vendue>;<mois>;<ann√©e>;<commentaire>
----

Le programme, apr√®s avoir v√©rifi√© le nombre de champs (6) de chacune de ces lignes, *affiche le d√©tail* des informations  (Mois,  Ann√©e, Public, Code Produit, Qt√© vendue et Commentaire)

Il y a deux cas de figure :

- Le code produit est le m√™me, alors les informations ne seront affich√©es qu'une seule fois,
- Le code produit est diff√©rent, les informations seront affich√©es en deux fois.

Exemples de sc√©narios √† reproduire

.Sc√©nario A (m√™me code produit pour les deux lignes)
[listing]
----
Entrez une premi√®re ligne d'informations de ventes :
F;a12;21;mars;2023; Attention, l√©ger d√©faut...

Entrez une deuxi√®me ligne d'informations de ventes :
F;a12;14;avril;2023; Attention, l√©ger d√©faut...

Voici la fiche produit :

	Date : MARS-2001, AVRIL-2023
	Public : FEMME
	Code Produit : A12
	Qt√© vendue  : 35
	Commentaire : Attention, l√©ger d√©faut...
----

.Sc√©nario B (codes diff√©rents, une ligne sans commentaire)
[listing]
----
Entrez une premi√®re ligne d'informations de ventes :
F;a12;21;mars;2023; Attention, l√©ger d√©faut...
Entrez une deuxi√®me ligne d'informations de ventes :
H;d45;11;mars;2023;

Voici les fiches produit :

Date : MARS-2023
Public : FEMME
Code Produit : A12
Qt√© vendue  : 21
Commentaire : Attention, l√©ger d√©faut...

Date : MARS-2023
Public : HOMME
Code Produit : D45
Qt√© vendue  : 11
Commentaire : AUCUN
----


.Sc√©nario C (mauvais format de ligne)
[listing]
----
Entrez une premi√®re ligne d'informations de ventes :
F;a12;21;mars-2001; Attention, l√©ger d√©faut...
ERREUR de format !
----

[TIP]
====
Pour √©viter de faire saisir les 2 lignes √† l'utilisateur, vous pouvez lui demander de passer ces informations en argument du programme. Exemple :

`$ python  tp2Final.py < produits.txt`

o√π `produits.txt` est un fichier texte contenant 2 lignes de produits au format attendu (transmis sur le canal standard)

Le module `fileinput` est tr√®s pratique pour ce type d'exploitation. L'exemple ci-dessous affiche le contenu du fichier re√ßu en argument - *en fait il lit l'entr√©e standard jusqu'√† attendre le symbole de fin de transmission (U+0004 - CTRL+D)* (ou CTRL+Z sous windows). Testez-le !

[source, python]
----
# https://docs.python.org/3/library/fileinput.html
def process_data() :
    import fileinput
    for line in fileinput.input(encoding="utf-8"):
        print(line)
----

====

=== EXERCICE 27

On se place dans le sc√©nario A. Nous appellerons *A'* (A prime) ce sc√©nario √©tendu. Le voici : 

_Si le code produit est de nouveau saisi sur la deuxi√®me ligne, alors on consid√®re que l'utilisateur souhaite une mise √† jour du produit.
*Seuls les champs renseign√©s lors de cette seconde saisie seront mis √† jour*._


.*Travail √† faire*
. Donner un exemple de sc√©nario A', avec des valeurs comme dans l'√©nonc√©.
. Impl√©menter et, bien entendu, tester le sc√©nario A'

=== EXERCICE HACKING 28

Voici un programme python faisant usage de caract√®res unicode non conventionnels. Certains de ces caract√®res peuvent ne pas avoir un glyphe sp√©cifique associ√© !!

C'est une technique d'*obfuscation de code source*, bien connue des hackers malveillants, cherchant √† d√©courager les personnes souhaitant comprendre le code source (souvent encod√© √† la base)

On vous assure que ce code est sans risque ! n'h√©sitez pas √† l'ex√©cuter.

.*Travail √† faire*
. Votre mission consiste √† d√©chiffrer ce code (*le remettre en clair*), en expliquant votre d√©marche.

[source, python]
----
import sys as Íû≥ùëø
import random as X
X.seed('ùíô')
ùíô = [print,"Hello World !",2,"Hello",__name__,1,"",len,"__main__","!"]
X.shuffle(ùíô)

def Íû≥(ùëø):
    if ùëø:
        ùíô[0](ùíô[1], ùëø, ùíô[2])
    else:
        ùíô[0](ùíô[3])
if (ùíô[4] == ùíô[5]):
    (Íû≥(ùíô[8]) if (ùíô[6](Íû≥ùëø.argv) < ùíô[7]) else Íû≥(Íû≥ùëø.argv[ùíô[9]]))

----


== Contr√¥ler vos connaissances et contribuer aux QCMs

. Contr√¥ler vos connaissances sur https://quizbe.org/question?id-selected-topic=6[quizbe.org]. (choisir `PYTHON-1`, scope `p-2-type`)
. Proposer, pour le th√®me `PYTHON-LDV`, scope `p-2-type`, 2 questions QCM originales et personnelles, sur des th√®mes couverts pas cette s√©quence d'exercices.



